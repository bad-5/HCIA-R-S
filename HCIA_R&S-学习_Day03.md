	姓名：王杰
	学习时间：2020年3月30日
	整理时间：2020年3月30日

# 复习回顾

## 网络互联基础

1. IP编址
**例**：已知192.168.11.3/28，计算该IP的子网是多少？广播地址是多少？可用IP有哪些？

- **算跨度**：
	* 子网掩码为28，在24到32之间，所以基准值为`32`
	* `基准值-子网掩码=n=32-28=4`
	* `跨度=2^n=2^4=16`
- **列出所有子网**：
	* 192.168.11.0
	* 192.168.11.16
	* 196.168.11.32
	* 196.168.11.48
	* ...
- **查看IP地址的范围**：

| 子网 | 广播地址 | 可用地址范围 |
|:---:|:---:|:---:|
| 192.168.11.0 | 192.168.11.15 | 192.168.11.1-192.168.11.14 |
| 192.168.11.16 | 192.168.11.31 | 192.168.11.17-192.168.11.30 |
| 192.168.11.32 | 192.168.11.47 | 192.168.11.31-192.168.11.46 |
...

> - 算出跨度之后，就可以得到每个子网，下一个子网主机位-1即为上一个子网的广播地址
> - 可用地址范围即除广播地址和网段外的所有地址

## 交换技术

- 一台交换机可以划分2^12=4096个VLAN，取值为0-4095，保留位为0和4095，可用VLAN为1-4094，默认为1（所有端口）
- 接口类型：
	* Access：接入链路，连接主机
	* Trunk：干道链路，连接交换机
	* Hybird：既可以连接主机也可以连接交换机
- VLAN间的通信方式：
	* **单臂路由**：
	1. 将接口划入相应的VLAN
	2. 交换机与路由器的接口要配置成Trunk，允许VLAN通过
	3. 路由器划分子接口，并为子接口配置IP
	4. 路由器子接口需要封装对应的VLAN ID
	5. 路由器子接口开启ARP广播
	* **三层交换**：
	1. 起VLANIF的三层接口，配置IP地址（IP地址即为主机的网关地址）
- STP：生成树
	* 构建生成树
	1. 选举根桥（ROOT）：优先级（默认32768）、MAC，选值小的
	2. 选举根端口（RP）：在非根交换机上选举根端口（COST，发送者的BID、PID，接受者的PID）
	3. 选举指定端口（DP）：在网段上选举指定端口（COST，发送者的BID、PID，接受者的PID）
	4. 选举阻塞端口（AP）：非根端口、非指定端口

# 路由协议基础与实现

## VRP基础

交换机可以隔离冲突域，路由器可以隔离广播域。网络设备的增多使网络负担变重，可以通过华为专有的VRP系统来提升运行效率。通用路由平台VRP（Versatile Routing Platform）

- **特点**：
	* 网络操作系统
	* 支持多种设备的软件平台（路由器、交换机、防火墙）
	* 提供TCP/IP的路由服务
- **PC和路由器的互联方式**：
	* console线
	* mini USB（需要安装驱动一端连接PC的USB接口，一端连接console口）

- VRP的发展

![1585639147279](E:%5CBad%5CPictures%5CTypora%20Picture%5C1585639147279.png)

## 命令行基础

![1585640307888](E:%5CBad%5CPictures%5CTypora%20Picture%5C1585640307888.png)

```bash
<Huawei>system-view  //用户视图进入系统视图
[Huawei]  //系统视图
[Huawei]interface GigabitEthernet 0/0/0
[Huawei-GigabitEthernet0/0/0]  //接口视图
[Huawei-ospf-1]  //协议视图
```
- `sysname` 修改设备名称
- `clock timezone BJ add 08:00:00`设置所在时区
- `clock datetime 15:48:29 2020-03-31`设置当前时间和日期
- `clock daylight-saving-time`设置采用夏时制
- `display clock`查看当前时间信息

> 以上命令都是在用户视图下使用

- 命令等级

| 用户等级 | 命令等级 | 名称 |
|:---:|:---:|:---:|
| 0 | 0 | 访问级 |
| 1 | 0 and 1 | 监控级 |
| 2 | 0,1 and 2 | 配置级 |
| 3-15 | 0,1,2 and 3 | 管理级 |

- 用户界面
	* console编号0，一个
	* VTY（Telnet登录）编号默认0-4，支持五个用户登录，最大可配范围0-14
- 配置用户界面命令
	* `idle-timeout`设置超时时间
	* `screen-length`设置指定终端屏幕的临时显示行数
	* `history-command max-size`设置历史命令缓冲区的大小
- 配置登录权限
	* `user privilege`配置指定用户界面下的用户级别
	* `set authentication password`配置本地认证密码
- 配置文件查询
	* `display current-configuration`显示当前配置文件
	* `display saved-configuration`显示保存的配置文件
	* `save`保存当前配置信息
	* `reset saved-configuration`清除下次启动时加载的配置文件

## IP路由基础

**路由**：源到目标网络所经过的路径

- **自治系统（AS）**：由同一个管理机构管理、使用统一路由策略的路由器集合

- **路由选路**：路由器负责为数据包选择一条最优路径，并进行转发

- 路由类型：
	* 静态路由
	* 动态路由
	* 直连路由

**路由协议**

- 按作用分类：
	* IGP：内部网关路由协议，企业内部所运行的路由协议
	* BGP：外部网关路由协议
- 按算法分类：
	* 距离矢量型的路由协议：RIP、BGP
	* 链路状态的路由协议：OSPF、ISIS

优先级

| 协议 | 优先级 |
|:---:|:---:|
| DIRECT | 0 |
| OSPF | 10 |
| ISIS | 15 |
| 静态 | 60 |
| RIP | 100 |
| OSPF-ASE | 150 |

- IP路由表

**命令**：`display ip routing-table`查看路由表

> - `Destination/Mask`：目的网段/掩码
> - `Proto`：路由协议（Static是指静态路由，Direct是指直连路由）
> - `Pre`：路由协议的优先级
> - `Cost`：开销
> - `NextHop`：下一跳
> - `Interface`：转发接口

- 最长匹配原则：
	* 路由表中有多个匹配目的网络的路条目时，路由器会选择掩码最长的条目
- 路由的度量
	* 即为COST值，从源到目标经过路径的花费（开销）

## 静态路由基础

静态路由是指手动配置和维护的路由

- 静态路由
	* 在广播型的接口上配置静态路由时，必须指定下一跳
	* **命令**：`ip route-static 目的网段 子网掩码 下一跳`
- 负载分担
	* 等价路由、ECNP
	* 静态路由支持到达同一目的地的等价负载分担
- 路由备份
	* 浮动静态路由
	* 在网中主路由失效时，浮动静态路由会加入到路由表并承担数据转发业务
- 缺省路由
	* 目的地址和掩码都全为0
	* 如果报文的目的地址无法匹配路由表中的任何一项，路由器将选择依照缺省路由来转发报文



## 距离矢量路由协议-RIP

## 链路状态路由协议-OSPF




































































